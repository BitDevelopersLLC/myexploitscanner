insert into users (user_guid,user_email,user_password,user_name) 
values (UUID(),'randolphmorris@gmail.com',SHA2('nicoletta',256),'RandolphM');
select * from users;
select count(*) as reccount from users where user_email='randolphmorris@gmail.com' 
	and user_password=(SHA2('nicolett2a',256));
    
--delete from users where user_key < 1000;

insert into scantypes (scantype_name, scantype_description) 
values ('NMAP Vul Scan','Runs a NMAP Vulnerability Scan on the specified URI.');
select * from scantypes;
update scantypes set scantype_key=1 where scantype_key=5;
--delete from scantypes where scantype_key < 100;

insert into scans (scan_guid,scan_scantype_ID,scan_uri) 
values (UUID(),5,'bitdevelopers.com');
select * from scans;
update scans set scan_status=0 where scan_key in (1,2);
update scans set scan_scantype_ID=1 where scan_key=4;
--delete from scans where scan_key < 1000;

CALL user_create('randolphmorris@gmail.com','nicoletta','RandolphM');
CALL user_update_email(9, 'randolph@bitdevelopers.com');
CALL user_update_password(9,'nicoletta2');
CALL user_update_name(9,'Randolph2');
CALL user_update_status(9,1);
CALL user_update_active(9,1);
CALL user_view_bykey(9);
CALL user_view_byguid('865d540d-bd45-11ee-a1de-fac9e1318913');
CALL user_view_bystatus(1);
CALL user_view_byactive(1);
CALL scantype_view_all;
CALL scan_create(5,'bitdevelopers.com',13);
CALL scan_update_scantype(3, 1);
CALL scan_update_uri(3, 'bitdevelopers.com');
CALL scan_update_status(4, 0);
CALL scan_update_user_id(3, 9);
CALL scan_view_bykey(4);
CALL scan_view_byguid('e1575604-bd49-11ee-a1de-fac9e1318913');
CALL scan_view_bystatus(0);


CALL scan_create(1,'bitdevelopers.com',1);
CALL scan_create(1,'134.122.6.33',1);

DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `user_login`(
	IN p_email VARCHAR(255),
	IN p_password VARCHAR(255)
)
BEGIN
	select count(*) as reccount 
    from users 
    where user_email= p_email 
	and user_password= (SHA2(p_password,256));
END$$
DELIMITER ;





